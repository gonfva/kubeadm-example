- hosts: localhost
  roles:
    - infra

- hosts: master
  remote_user: centos
  become: true
  roles:
    - role: machines
      vars:
        hostname: k8sm1
    - kubernetes_ini
    - nginx

- hosts: minions
  remote_user: centos
  become: true
  roles:
    - role: machines
      vars:
        hostname: k8sn{{groups['minions'].index(inventory_hostname)|int + 1}}
    - kubernetes_join
